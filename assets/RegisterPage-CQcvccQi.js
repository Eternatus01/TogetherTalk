import{d as f,r as t,u as U,a as w,s as p,c as E,w as d,v as m,b as l,t as _,o as x}from"./index-B_YhoeON.js";import{u as y}from"./errors-ptkwsH4S.js";const R=f("userRegister",()=>{const u=t(""),r=t(""),s=t(""),a=y(),n=U(),i=w();async function c(){const{data:v,error:e}=await p.from("users").select("id").eq("username",s.value).single();if(e&&e.code!=="PGRST116"){console.error("Ошибка при проверке имени пользователя:",e);return}if(v){console.error("Имя пользователя уже занято. Пожалуйста, выберите другое."),a.setErrors("Имя пользователя уже занято. Пожалуйста, выберите другое.");return}const{error:o}=await p.auth.signUp({email:u.value,password:r.value});if(o){console.error("Ошибка при регистрации:",o);return}const{error:g}=await p.from("users").insert([{username:s.value,email:u.value}]).select();g?console.error("Ошибка при добавлении имени пользователя:",g):(console.log("Пользователь успешно зарегистрирован с именем пользователя:",s.value),n.push("/"),await i.getUser())}return{registerUser:c,email:u,password:r,username:s}}),b={class:"form"},h={__name:"RegisterPage",setup(u){const r=R(),s=t(""),a=t(""),n=t(""),i=()=>{r.email=s.value,r.password=a.value,r.username=n.value,r.registerUser()},c=t(r.errorMessages);return(v,e)=>(x(),E("div",b,[d(l("input",{type:"text",id:"username","onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),placeholder:"Имя пользователя"},null,512),[[m,n.value]]),d(l("input",{type:"email",id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>s.value=o),placeholder:"Почта"},null,512),[[m,s.value]]),d(l("input",{type:"password",id:"password","onUpdate:modelValue":e[2]||(e[2]=o=>a.value=o),placeholder:"Пароль"},null,512),[[m,a.value]]),l("button",{onClick:i,class:"form__btn"},"Зарегистрироваться"),l("pre",null,_(c.value),1)]))}};export{h as default};
