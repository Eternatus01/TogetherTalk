import{f as l,$ as g,j as p,t as m,o as u,l as w,G as U,C as h,Z as y,B as R,c as d}from"./index-QomUHjFO.js";import{u as _}from"./errors-ptkwsH4S-CVFA_oyv.js";const b=U("userRegister",()=>{const n=l(""),r=l(""),a=l(""),o=_(),t=h(),i=y();async function c(){const{data:v,error:e}=await d.from("users").select("id").eq("username",a.value).single();if(e&&e.code!=="PGRST116"){console.error("Ошибка при проверке имени пользователя:",e);return}if(v){console.error("Имя пользователя уже занято. Пожалуйста, выберите другое."),o.setErrors("Имя пользователя уже занято. Пожалуйста, выберите другое.");return}const{error:s}=await d.auth.signUp({email:n.value,password:r.value});if(s){console.error("Ошибка при регистрации:",s);return}const{error:f}=await d.from("users").insert([{username:a.value,email:n.value}]).select();f?console.error("Ошибка при добавлении имени пользователя:",f):(console.log("Пользователь успешно зарегистрирован с именем пользователя:",a.value),t.push("/"),await i.getUser())}return{registerUser:c,email:n,password:r,username:a}}),C={class:"form"},$={__name:"RegisterPage",setup(n){const r=b(),a=l(""),o=l(""),t=l(""),i=()=>{r.email=a.value,r.password=o.value,r.username=t.value,r.registerUser()},c=l(r.errorMessages);return(v,e)=>(R(),g("div",C,[p(u("input",{type:"text",id:"username","onUpdate:modelValue":e[0]||(e[0]=s=>t.value=s),placeholder:"Имя пользователя"},null,512),[[m,t.value]]),p(u("input",{type:"email",id:"email","onUpdate:modelValue":e[1]||(e[1]=s=>a.value=s),placeholder:"Почта"},null,512),[[m,a.value]]),p(u("input",{type:"password",id:"password","onUpdate:modelValue":e[2]||(e[2]=s=>o.value=s),placeholder:"Пароль"},null,512),[[m,o.value]]),u("button",{onClick:i,class:"form__btn"},"Зарегистрироваться"),u("pre",null,w(c.value),1)]))}};export{$ as default};
